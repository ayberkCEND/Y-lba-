<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ„ Ayberk'ten YÄ±lbaÅŸÄ± SÃ¼rprizi</title>
  <style>
    :root{
      --bg1:#07111f; --bg2:#0b1f2e;
      --glass: rgba(255,255,255,.08);
      --glass2: rgba(255,255,255,.14);
      --txt: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --bad: rgba(255,90,90,.92);
      --ok: rgba(90,255,170,.92);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--txt);
      overflow:hidden;
      background: radial-gradient(1200px 800px at 30% 20%, #173a5a 0%, var(--bg1) 45%, var(--bg2) 100%);
    }
    .aurora{
      position:fixed; inset:-20%;
      background:
        radial-gradient(700px 400px at 20% 30%, rgba(0,255,180,.22), transparent 60%),
        radial-gradient(600px 380px at 80% 40%, rgba(255,0,120,.18), transparent 60%),
        radial-gradient(600px 420px at 50% 80%, rgba(80,140,255,.20), transparent 65%);
      filter: blur(40px);
      animation: drift 10s ease-in-out infinite alternate;
      pointer-events:none;
    }
    @keyframes drift{
      from{ transform: translate3d(-2%, -1%, 0) scale(1.02); opacity:.85;}
      to  { transform: translate3d(2%, 1%, 0) scale(1.05); opacity:1;}
    }
    canvas{ position:fixed; inset:0; pointer-events:none; }

    .wrap{
      position:relative;
      height:100%;
      display:grid;
      place-items:center;
      padding:24px;
    }
    .card{
      width:min(820px, 94vw);
      background: linear-gradient(180deg, var(--glass2), var(--glass));
      border:1px solid rgba(255,255,255,.12);
      border-radius:26px;
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      backdrop-filter: blur(12px);
      padding:28px;
    }
    .top{
      display:flex; align-items:center; justify-content:space-between;
      gap:14px; flex-wrap:wrap; margin-bottom:18px;
    }
    .badge{
      display:inline-flex; gap:10px; align-items:center;
      padding:10px 14px; border-radius:999px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.12);
      font-weight:650; letter-spacing:.2px;
    }
    h1{ margin:10px 0 6px; font-size: clamp(26px, 3.6vw, 40px); line-height:1.12; }
    p{ margin:0 0 12px; color:var(--muted); font-size: clamp(14px, 1.8vw, 18px); }

    .count{
      margin-top:16px;
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap:12px;
    }
    .tile{
      padding:14px 12px;
      border-radius:18px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.10);
      text-align:center;
    }
    .num{ font-size: clamp(22px, 3.2vw, 34px); font-weight:850; letter-spacing:.5px; }
    .lbl{ margin-top:4px; font-size:12px; opacity:.78; text-transform: uppercase; letter-spacing:1.2px; }

    .row{
      margin-top:16px;
      display:flex; gap:12px; flex-wrap:wrap;
      align-items:center; justify-content:space-between;
    }
    .btn{
      cursor:pointer;
      border:0;
      border-radius:16px;
      padding:12px 16px;
      font-weight:780;
      color:var(--txt);
      background: linear-gradient(135deg, rgba(255,255,255,.20), rgba(255,255,255,.10));
      border:1px solid rgba(255,255,255,.14);
      transition:.18s transform ease, .18s opacity ease, .18s filter ease;
      display:inline-flex; align-items:center; gap:10px;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-1px); filter: brightness(1.05);}
    .btn:active{ transform: translateY(1px); opacity:.9;}
    .hint{ font-size:12px; opacity:.75; }
    .foot{
      margin-top:12px;
      display:flex; justify-content:space-between; gap:12px;
      flex-wrap:wrap; opacity:.72; font-size:12px;
    }
    .foot span{white-space:nowrap}

    .modal{
      position:fixed; inset:0;
      display:none; place-items:center;
      background: rgba(0,0,0,.50);
      padding:24px;
    }
    .modal.open{ display:grid; }
    .box{
      width:min(760px, 94vw);
      border-radius:22px;
      background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.07));
      border:1px solid rgba(255,255,255,.14);
      backdrop-filter: blur(14px);
      padding:22px;
      box-shadow: 0 18px 60px rgba(0,0,0,.55);
      position:relative;
      overflow:hidden;
      max-height: 82vh;
      overflow:auto;
    }
    .close{
      position:absolute; top:12px; right:12px;
      width:42px; height:42px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color:var(--txt);
      cursor:pointer;
      font-size:18px;
    }
    .gift{
      margin-top:12px;
      padding:14px;
      border-radius:18px;
      background: rgba(0,0,0,.20);
      border:1px dashed rgba(255,255,255,.18);
      font-weight:720;
    }

    .panel{
      margin-top:14px;
      padding:14px;
      border-radius:18px;
      background: rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.10);
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width:720px){
      .grid{ grid-template-columns: 1fr; }
    }
    label{ font-size:12px; opacity:.8; display:block; margin:6px 0; }
    input, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--txt);
      outline:none;
      font-size:14px;
    }
    textarea{ min-height: 90px; resize: vertical; }
    .metaRow{
      margin-top:10px;
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      flex-wrap:wrap;
    }
    .status{
      font-size:12px;
      opacity:.85;
      padding:8px 10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
    }
    .status.ok{ color: var(--ok); }
    .status.bad{ color: var(--bad); }

    .notes{
      margin-top:12px;
      display:grid;
      gap:10px;
    }
    .note{
      padding:12px;
      border-radius:16px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
    }
    .noteTop{
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
      align-items:center;
      margin-bottom:6px;
    }
    .noteName{ font-weight:800; }
    .noteTime{ font-size:12px; opacity:.70; }
    .noteMsg{ white-space:pre-wrap; color: var(--muted); }
  </style>
</head>

<body>
  <div class="aurora"></div>
  <canvas id="snow"></canvas>

  <div class="wrap">
    <div class="card">
      <div class="top">
        <div class="badge">ğŸ„ <small>Ayberk'ten</small> <b>YÄ±lbaÅŸÄ± SÃ¼rprizi</b></div>
        <div class="badge">âœ¨ <small>Geri sayÄ±m</small> <b>2026</b></div>
      </div>

      <h1>ğŸ… EÄŸer bu siteye geldiysen Ayberk yÄ±lbaÅŸÄ±nÄ± kutluyor...</h1>
      <p>
        Hediyeyi aÃ§Ä±nca mesajÄ± gÃ¶receksin ve istersen herkese aÃ§Ä±k bir not bÄ±rakabileceksin.
        (Notlar burada canlÄ± gÃ¶rÃ¼nÃ¼r.)
      </p>

      <div class="count">
        <div class="tile"><div class="num" id="d">--</div><div class="lbl">GÃ¼n</div></div>
        <div class="tile"><div class="num" id="h">--</div><div class="lbl">Saat</div></div>
        <div class="tile"><div class="num" id="m">--</div><div class="lbl">Dakika</div></div>
        <div class="tile"><div class="num" id="s">--</div><div class="lbl">Saniye</div></div>
      </div>

      <div class="row">
        <button class="btn" id="openGift">ğŸ Hediyeyi AÃ§</button>
        <button class="btn" id="musicBtn">ğŸ”Š MÃ¼zik: KapalÄ±</button>
        <div class="hint">Notlar iÃ§in Firebaseâ€™i baÄŸladÄ±ktan sonra herkes birbirinin notunu gÃ¶rÃ¼r.</div>
      </div>

      <div class="foot">
        <span>â„ï¸ Kar efekti: aÃ§Ä±k</span>
        <span>ğŸ•’ Saat: <b id="clock">--:--:--</b></span>
      </div>
    </div>
  </div>

  <div class="modal" id="modal">
    <div class="box">
      <button class="close" id="close">âœ–</button>
      <h2>ğŸ„ YÄ±lbaÅŸÄ±n kutlu olsun!</h2>
      <p id="surprizText"></p>
      <div class="gift" id="giftBox"></div>

      <div class="panel">
        <h3 style="margin:0 0 6px;">âœï¸ Ayberk'e Not BÄ±rak</h3>
        <p style="margin:0 0 10px; color:var(--muted);">
          YazdÄ±ÄŸÄ±n notlar herkese aÃ§Ä±k gÃ¶rÃ¼nÃ¼r. AbartÄ± kÃ¼fÃ¼r/rahatsÄ±zlÄ±k yok ğŸ˜„
        </p>

        <div class="grid">
          <div>
            <label>AdÄ±n / Takma adÄ±n</label>
            <input id="nameInput" maxlength="30" placeholder="Ã¶rn: AnÄ±l" />
          </div>
          <div>
            <label>Emoji (opsiyonel)</label>
            <input id="emojiInput" maxlength="2" placeholder="Ã¶rn: ğŸ„" />
          </div>
        </div>

        <label>Notun</label>
        <textarea id="msgInput" maxlength="240" placeholder="Mutlu yÄ±llar Ayberk! ..."></textarea>

        <div class="metaRow">
          <button class="btn" id="sendBtn">ğŸ“¨ Notu GÃ¶nder</button>
          <span class="status" id="dbStatus">â³ Not sistemi baÄŸlanÄ±yor...</span>
        </div>
      </div>

      <div class="panel">
        <h3 style="margin:0 0 8px;">ğŸ“œ BÄ±rakÄ±lan Notlar</h3>
        <div class="notes" id="notes"></div>
      </div>
    </div>
  </div>

  <!-- Firebase (modÃ¼ler) -->
  <script type="module">
    // âœ… BURAYI Ä°STEDÄ°ÄÄ°N GÄ°BÄ° DÃœZENLE
    const SURPRIZ = "âœ¨ Ayberkâ€™ten kocaman mutlu yÄ±llar! Yeni yÄ±l sana saÄŸlÄ±k, para ve huzur getirsin ğŸ˜„";
    const HEDIYE  = "ğŸ AÅŸaÄŸÄ±ya bir not bÄ±rak, herkes gÃ¶rsÃ¼n!";

    // âœ… Firebase config buraya gelecek (Firebase Console â†’ Project settings â†’ Your apps â†’ Web)
    // Bu bloÄŸu aynen kendi configâ€™inle deÄŸiÅŸtir:
    const firebaseConfig = FIREBASE_CONFIG_BURAYA;

    // --- UI helpers
    const el = (id)=>document.getElementById(id);
    const pad = (n)=>String(n).padStart(2,"0");

    // --- Countdown (1 Ocak 2026)
    const target = new Date("2026-01-01T00:00:00");
    function tick(){
      const now = new Date();
      el("clock").textContent = `${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
      let diff = target - now;
      if(diff < 0) diff = 0;
      const s = Math.floor(diff/1000);
      const d = Math.floor(s/86400);
      const h = Math.floor((s%86400)/3600);
      const m = Math.floor((s%3600)/60);
      const sec = s%60;
      el("d").textContent = d;
      el("h").textContent = pad(h);
      el("m").textContent = pad(m);
      el("s").textContent = pad(sec);
    }
    setInterval(tick, 1000); tick();

    // --- Modal
    const modal = el("modal");
    el("openGift").onclick = ()=>{
      el("surprizText").textContent = SURPRIZ;
      el("giftBox").textContent = HEDIYE;
      modal.classList.add("open");
      burst();
    };
    el("close").onclick = ()=> modal.classList.remove("open");
    modal.addEventListener("click", (e)=>{ if(e.target === modal) modal.classList.remove("open"); });

    // --- Snow
    const canvas = el("snow");
    const ctx = canvas.getContext("2d");
    let W, H, flakes=[];
    function resize(){
      W = canvas.width = window.innerWidth * devicePixelRatio;
      H = canvas.height = window.innerHeight * devicePixelRatio;
    }
    window.addEventListener("resize", resize);
    resize();
    function makeFlake(){
      const r = (Math.random()*2.2 + 0.8) * devicePixelRatio;
      return { x: Math.random()*W, y: -10*devicePixelRatio, r,
               vy: (Math.random()*1.2 + 0.6) * devicePixelRatio,
               vx: (Math.random()*0.6 - 0.3) * devicePixelRatio,
               a: Math.random()*Math.PI*2 };
    }
    for(let i=0;i<220;i++){ const f = makeFlake(); f.y = Math.random()*H; flakes.push(f); }
    function draw(){
      ctx.clearRect(0,0,W,H);
      ctx.globalAlpha = 0.95;
      for(const f of flakes){
        f.a += 0.01;
        f.x += f.vx + Math.sin(f.a)*0.25*devicePixelRatio;
        f.y += f.vy;
        if(f.y > H + 20*devicePixelRatio) Object.assign(f, makeFlake());
        if(f.x < -20*devicePixelRatio) f.x = W + 20*devicePixelRatio;
        if(f.x > W + 20*devicePixelRatio) f.x = -20*devicePixelRatio;
        ctx.beginPath(); ctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
        ctx.fillStyle = "rgba(255,255,255,.9)"; ctx.fill();
      }
      requestAnimationFrame(draw);
    }
    draw();

    // --- Confetti burst (mini)
    function burst(){
      const n = 120, parts = [];
      const cx = W/2, cy = H/2;
      for(let i=0;i<n;i++){
        parts.push({
          x: cx, y: cy,
          vx: (Math.random()*8-4)*devicePixelRatio,
          vy: (Math.random()*8-6)*devicePixelRatio,
          g: 0.18*devicePixelRatio,
          life: 80 + Math.random()*30
        });
      }
      let t = 0;
      const run = ()=>{
        t++;
        for(const p of parts){
          p.vy += p.g; p.x += p.vx; p.y += p.vy; p.life -= 1;
          ctx.fillStyle = `rgba(255,255,255,${Math.max(p.life/110,0)})`;
          ctx.fillRect(p.x, p.y, 3*devicePixelRatio, 3*devicePixelRatio);
        }
        if(t < 90) requestAnimationFrame(run);
      };
      run();
    }

    // --- Music (mini jingle)
    let audioOn = false, ac, timer;
    function beep(freq, dur=0.12, vol=0.06){
      const o = ac.createOscillator();
      const g = ac.createGain();
      o.type = "sine"; o.frequency.value = freq;
      g.gain.value = vol;
      o.connect(g); g.connect(ac.destination);
      o.start(); o.stop(ac.currentTime + dur);
    }
    function playJingle(){
      const notes = [659,659,659, 659,659,659, 659,784,523,587,659, 698,698,698, 698,659,659, 659,587,587,659,587,784];
      let i=0;
      timer = setInterval(()=>{
        if(!audioOn) return;
        beep(notes[i%notes.length], 0.10, 0.05);
        i++;
      }, 140);
    }
    el("musicBtn").onclick = async ()=>{
      if(!audioOn){
        ac = ac || new (window.AudioContext || window.webkitAudioContext)();
        if(ac.state === "suspended") await ac.resume();
        audioOn = true;
        el("musicBtn").textContent = "ğŸ”Š MÃ¼zik: AÃ§Ä±k";
        playJingle();
      }else{
        audioOn = false;
        el("musicBtn").textContent = "ğŸ”Š MÃ¼zik: KapalÄ±";
        clearInterval(timer);
      }
    };

    // =========================
    // Firebase Notes (Firestore)
    // =========================
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
    import {
      getFirestore, collection, addDoc, serverTimestamp,
      query, orderBy, limit, onSnapshot
    } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

    const statusEl = el("dbStatus");
    const notesEl = el("notes");

    function setStatus(text, ok=null){
      statusEl.textContent = text;
      statusEl.classList.remove("ok","bad");
      if(ok === true) statusEl.classList.add("ok");
      if(ok === false) statusEl.classList.add("bad");
    }

    function safeText(s){
      return (s || "").toString().replace(/\s+/g," ").trim();
    }
    function fmtTime(ts){
      try{
        const d = ts?.toDate ? ts.toDate() : null;
        if(!d) return "";
        return d.toLocaleString("tr-TR", { dateStyle:"short", timeStyle:"short" });
      }catch{ return ""; }
    }

    let db;
    try{
      const app = initializeApp(firebaseConfig);
      db = getFirestore(app);
      setStatus("âœ… Not sistemi aktif!", true);
    }catch(e){
      setStatus("âš ï¸ Firebase baÄŸlanmadÄ±: config eklemen lazÄ±m.", false);
    }

    function renderNotes(docs){
      notesEl.innerHTML = "";
      if(docs.length === 0){
        const div = document.createElement("div");
        div.className = "note";
        div.innerHTML = `<div class="noteMsg">HenÃ¼z not yok. Ä°lk notu sen bÄ±rak ğŸ˜„</div>`;
        notesEl.appendChild(div);
        return;
      }
      for(const d of docs){
        const data = d.data();
        const name = data.name || "Anonim";
        const emoji = data.emoji || "ğŸ„";
        const msg = data.message || "";
        const time = fmtTime(data.createdAt);
        const card = document.createElement("div");
        card.className = "note";
        card.innerHTML = `
          <div class="noteTop">
            <div class="noteName">${emoji} ${escapeHtml(name)}</div>
            <div class="noteTime">${escapeHtml(time)}</div>
          </div>
          <div class="noteMsg">${escapeHtml(msg)}</div>
        `;
        notesEl.appendChild(card);
      }
    }

    function escapeHtml(str){
      return (str ?? "").toString()
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    if(db){
      const q = query(collection(db, "notes"), orderBy("createdAt","desc"), limit(60));
      onSnapshot(q, (snap)=>{
        renderNotes(snap.docs);
      }, ()=>{
        setStatus("âš ï¸ Notlar okunamadÄ± (Firestore izinleri?).", false);
      });
    }

    el("sendBtn").onclick = async ()=>{
      if(!db){
        alert("Firebase baÄŸlÄ± deÄŸil. Ã–nce firebaseConfig eklemelisin.");
        return;
      }
      const name = safeText(el("nameInput").value) || "Anonim";
      const emoji = safeText(el("emojiInput").value) || "ğŸ„";
      const message = (el("msgInput").value || "").trim();

      if(message.length < 2){
        alert("Not Ã§ok kÄ±sa kanka ğŸ˜„ Biraz daha yaz.");
        return;
      }
      if(message.length > 240){
        alert("Not Ã§ok uzun (max 240 karakter).");
        return;
      }

      el("sendBtn").disabled = true;
      el("sendBtn").textContent = "â³ GÃ¶nderiliyor...";

      try{
        await addDoc(collection(db, "notes"), {
          name: name.slice(0,30),
          emoji: emoji.slice(0,2),
          message,
          createdAt: serverTimestamp()
        });
        el("msgInput").value = "";
        setStatus("âœ… Not gÃ¶nderildi!", true);
        setTimeout(()=> setStatus("âœ… Not sistemi aktif!", true), 1200);
      }catch(e){
        console.error(e);
        setStatus("âŒ GÃ¶nderilemedi (Firestore izinleri?).", false);
        alert("Not gÃ¶nderilemedi. Firestore kurallarÄ±nÄ± kontrol et.");
      }finally{
        el("sendBtn").disabled = false;
        el("sendBtn").textContent = "ğŸ“¨ Notu GÃ¶nder";
      }
    };
  </script>
</body>
</html>
